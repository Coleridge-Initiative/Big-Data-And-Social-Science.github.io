distances <- read.csv("FSWdistances.csv",head=TRUE)
locrecruit$distance <- distances[as.matrix(data.frame(From = locrecruit$From, To = locrecruit$To))]
# Find the order of recruitment and find cumulative average distance of recruitment
dist_cumulative <- FSWdata[,c(1,3)] %>%
inner_join(locrecruit, by = c('RecruitID' = 'To')) %>%
arrange(RegistrationDate) %>%
mutate(cumdist = cumsum(distance),
avedist = cumdist / 1:nrow(locrecruit))
# Rolling median (25)
plot(rollmedian(dist_cumulative$distance, 25))
temp <- FSWdata[,c('PIN1Lon','PIN1Lat')] %>% filter(PIN1Lat < 1, PIN1Lat > 0)
final_area <- areaPolygon(temp[chull(temp),])/1000000
### Cumulative area by wave
nrange <- 100
rollarea <- rep(NA,(nrow(FSWdata)-nrange))
for(i in 1:(nrow(FSWdata)-nrange)){
temp <- FSWdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
plot(rollarea/1000000, type = 'l')
### Cumulative area by wave
nrange <- 30
rollarea <- rep(NA,(nrow(FSWdata)-nrange))
for(i in 1:(nrow(FSWdata)-nrange)){
temp <- FSWdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
# temp <- temp[-chull(temp),]
# temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
plot(rollarea/1000000, type = 'l')
temp <- FSWdata[,c('PIN1Lon','PIN1Lat')] %>% filter(PIN1Lat < 1, PIN1Lat > 0)
final_area <- areaPolygon(temp[chull(temp),])/1000000
### Cumulative area by wave
nrange <- 30
rollarea <- rep(NA,(nrow(FSWdata)-nrange))
for(i in 1:(nrow(FSWdata)-nrange)){
temp <- FSWdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
# temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
plot(rollarea/1000000, type = 'l')
head(FSWdata)
locrecruit
head(locrecruit)
head(FSWdata)
max(FSWdata$QUDATE)
max(FSWdata$QUDATE, na.rm=TRUE)
max(FSWdata$QUDATE, na.rm=TRUE)- min(FSWdata$QUDATE, na.rm=TRUE)
238/7
head(recruitment)
r <- left_join(recruitment,FSWdata, by = c('To' = "RecruitID"))
r2 <- data.frame(id = r$To,
recruiter.id = r$From,
network.size = as.numeric(r$SIZEWEE),
WAVE = r$WAVE) %>%
filter(!is.na(network.size) )
r2$recruiter.id <- as.character(r2$recruiter.id)
r2$recruiter.id[is.na(r2$recruiter.id)] = 0
FSWrdsdata <- as.rds.data.frame(r2, network.size = "network.size",max.coupons = 3)
FSWrdsdata
r2
r <- left_join(recruitment,FSWdata, by = c('To' = "RecruitID"))
r2 <- data.frame(id = r$To,
recruiter.id = r$From,
network.size = as.numeric(r$SIZEWEE),
date = QUDATE,
WAVE = r$WAVE) %>%
filter(!is.na(network.size) )
r2$recruiter.id <- as.character(r2$recruiter.id)
r2$recruiter.id[is.na(r2$recruiter.id)] = 0
r
r <- left_join(recruitment,FSWdata, by = c('To' = "RecruitID"))
r2 <- data.frame(id = r$To,
recruiter.id = r$From,
network.size = as.numeric(r$SIZEWEE),
date = r$QUDATE,
WAVE = r$WAVE) %>%
filter(!is.na(network.size) )
r2$recruiter.id <- as.character(r2$recruiter.id)
r2$recruiter.id[is.na(r2$recruiter.id)] = 0
?as.rds.data.frame
FSWrdsdata <- as.rds.data.frame(r2, network.size = "network.size",time = 'date',max.coupons = 3)
FSWrdsdata
posteriorsize(FSWrdsdata)
posteriorsize(FSWrdsdata, maxN = 10000)
posteriorsize(FSWrdsdata, maxN = 10000, parallel = detectCores()-2)
2
FSWsize <- posteriorsize(FSWrdsdata, maxN = 10000, parallel = detectCores()-2)
head(FSWrdsdata)
FSWsize <- posteriorsize(FSWrdsdata, maxN = 10000)
FSWsize <- posteriorsize(FSWrdsdata, maxN = 10000, visibility = FALSE)
warnings()
summary(FSWsize)
# Rolling median (25)
plot(rollmedian(dist_cumulative$distance, 25))
# Rolling median (25)
plot(rollmedian(dist_cumulative$distance, 25), type ='l')
# Rolling median (25)
plot(rollmedian(dist_cumulative$distance, 25), type ='l', xlab = "Distance of Recruitment (meters)")
# Rolling median (25)
plot(rollmedian(dist_cumulative$distance, 25), type ='l', ylab = "Distance of Recruitment (meters)")
plot(rollmedian(dist_cumulative$distance, 25), type ='l',
ylab = "Distance of Recruitment (meters)",
xlab = "Recruitment order")
rollmedian(dist_cumulative$distance, 25)
qplot(rollmedian(dist_cumulative$distance, 25)) + geom_line()
qplot(y=rollmedian(dist_cumulative$distance, 25)) + geom_line()
qplot(y=rollmedian(dist_cumulative$distance, 25)) + geom_line() +
xlab("Distance of Recruitment (meters)") + ylab("Recruitment order")
qplot(y=rollmedian(dist_cumulative$distance, 25)) + geom_line() +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order")
?qplot
qplot(y=rollmedian(dist_cumulative$distance, 25), geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order")
qplot(x=rollmedian(dist_cumulative$distance, 25), geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order")
# Rolling median (25)
MSMrollmed <- rollmedian(dist_cumulative$distance, 25)
# Rolling median (25)
MSMrollmed <- rollmedian(dist_cumulative$distance, 25)
qplot(x=1:length(MSMrollmed),y=MSMrollmed, 25), geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order")
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order")
median(locrecruit$distance)
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_abline(y = median(locrecruit$distance))
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(median(locrecruit$distance))
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(aes(median(locrecruit$distance)))
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(yintercept = median(locrecruit$distance))
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(yintercept = median(locrecruit$distance), linetype = 'dotted')
MSMrollmed <- rollmedian(dist_cumulative$distance, 35)
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(yintercept = median(locrecruit$distance), linetype = 'dotted')
MSMrollmed <- rollmedian(dist_cumulative$distance, 51)
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(yintercept = median(locrecruit$distance), linetype = 'dotted')
# Rolling median (25)
MSMrollmed <- rollmedian(dist_cumulative$distance, 101)
qplot(x=1:length(MSMrollmed),y=MSMrollmed, geom='line') +
ylab("Distance of Recruitment (meters)") + xlab("Recruitment order") +
geom_hline(yintercept = median(locrecruit$distance), linetype = 'dotted')
temp <- MSMdata[,c('PIN1Lon','PIN1Lat')] %>% filter(PIN1Lat < 1, PIN1Lat > 0)
final_area <- areaPolygon(temp[chull(temp),])
rollarea <- rep(NA,(nrow(MSMdata)-30))
for(i in 1:(nrow(MSMdata)-30)){
temp <- MSMdata[i:(i+30),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
plot(rollarea/1000000, type = 'l')
nrange <- 50
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
plot(rollarea/1000000, type = 'l')
##### Rolling Area ####
nrange <- 50
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
# temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
plot(rollarea/1000000, type = 'l')
qplot(rollarea/1000000, geom = 'line')
qplot(x = 1:length(rollarea), y= rollarea/1000000, geom = 'line')
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (Square km)") + xlab("Recruitment Order")
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
nrange <- 500
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
# temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
MSMconvexhull <- ggplot(dat, aes(x=Wave, y = Area)) + geom_line() +
ylab("Area")+ xlim(c(0,15))
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
nrange <- 100
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
# temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
nrange <- 100
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
nrange <- 50
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
rollarea1 <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
rollarea <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
# temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea[i] <- areaPolygon(temp[chull(temp),])
}
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
geom_line(x = 1:length(rollarea1), y = rollarea1/1000000, linetype='dashed')
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order")
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
qplot(x = 1:length(rollarea1), y = rollarea1/1000000, linetype='dashed')
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
qplot(aes(x = 1:length(rollarea1), y = rollarea1/1000000, linetype='dashed'))
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
geom_line(aes(x = 1:length(rollarea1), y = rollarea1/1000000, linetype='dashed'))
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
geom_line(data.frame(x = 1:length(rollarea1), y = rollarea1/1000000),aes(x=x,y=y, linetype='dashed'))
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
geom_line(data=data.frame(x = 1:length(rollarea1), y = rollarea1/1000000),aes(x=x,y=y, linetype='dashed'))
data.frame(x = 1:length(rollarea1),
y = rollarea1/1000000)
rollarea1
rollarea1 <- rep(NA,(nrow(MSMdata)-nrange))
for(i in 1:(nrow(MSMdata)-nrange)){
temp <- MSMdata[i:(i+nrange),] %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
#  temp <- temp[-chull(temp),]
rollarea1[i] <- areaPolygon(temp[chull(temp),])
}
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
geom_line(data=data.frame(x = 1:length(rollarea1),
y = rollarea1/1000000),
aes(x=x,y=y, linetype='dashed'))
qplot(x = 1:length(rollarea), y = rollarea/1000000, geom = 'line') +
ylab("Area of Convex Hull (square km)") + xlab("Recruitment Order") +
geom_line(data=data.frame(x = 1:length(rollarea1),
y = rollarea1/1000000),
aes(x=x,y=y), linetype='dashed')
ggplot(dat, aes(x=Wave, y = Area)) + geom_line() +
ylab("Area")+ xlim(c(0,15))
polyarea <- rep(NA, max(MSMdata$WAVE, na.rm=TRUE))
for(i in 1:max(MSMdata$WAVE,na.rm = TRUE)){
temp <- MSMdata %>% filter(WAVE <= i) %>% select(PIN1Lon, PIN1Lat) %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
temp <- temp[-chull(temp),]
# temp <- temp[-chull(temp),]
polyarea[i] <- areaPolygon(temp[chull(temp),])
}
dat <- data.frame(Wave = 1:max(MSMdata$WAVE,na.rm = TRUE), Area = polyarea/final_area)
ggplot(dat, aes(x=Wave, y = Area)) + geom_line() +
ylab("Area")+ xlim(c(0,15))
head(MSMdata)
rollmean(MSMdata %>% arrange(RegistrationDate) %>% select(Age))
rollmean(MSMdata %>% arrange(RegistrationDate) %>% select(Age), 51)
plot(rollmean(MSMdata %>% arrange(RegistrationDate) %>% select(Age), 51))
MSMordered <- MSMdata %>% arrange(RegistrationDate)
ggplot(MSMordered, aes(x = RegistrationDate, y = Age)) + geom_line()
ggplot(MSMordered, aes(x = RegistrationDate, y = rollmean(Age))) + geom_line()
ggplot(MSMordered, aes(x = RegistrationDate, y = rollmean(Age,51))) + geom_line()
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMrollage <- rollmean(Age,51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMrollage <- rollmean(MSMdata$Age,51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMrollage <- rollmean(MSMdata$Age %>% filter(Age == NA),51)
MSMdata$Age %>% filter(Age == NA)
MSMrollage <- rollmean(MSMdata$Age[MSMdata$Age != NA],51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMdata$Age[MSMdata$Age != NA
]
MSMordered <- MSMdata %>% arrange(RegistrationDate)
MSMrollage <- rollmean(MSMordered$Age[MSMdata$Age != NA],51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMordered
MSMrollage <- rollmean(MSMordered$Age[MSMordered$Age != NA],51)
MSMordered <- MSMdata %>% arrange(RegistrationDate)
MSMrollage <- rollmean(MSMordered$Age[MSMordered$Age != NA],51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMordered$Age
MSMordered$Age != NA
MSMordered
MSMordered$Age
MSMordered <- MSMdata %>% arrange(RegistrationDate)
MSMrollage <- rollmean(MSMordered$Age,51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line()
MSMordered <- MSMdata %>% arrange(RegistrationDate)
MSMrollage <- rollmean(MSMordered$Age,51)
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line() +
xlab("Recruitment Order") + ylab("Average Age")
ggplot(data.frame(x = 1:length(MSMrollage), y = MSMrollage), aes(x=x, y=y)) + geom_line() +
xlab("Recruitment Order") + ylab("Age (Rolling Average)")
FSWordered <- FSWdata %>% arrange(RegistrationDate)
FSWrollage <- rollmean(FSWordered$Age,51)
ggplot(data.frame(x = 1:length(FSWrollage), y = FSWrollage), aes(x=x, y=y)) + geom_line() +
xlab("Recruitment Order") + ylab("Age (Rolling Average)")
FSWcumage <- cumsum(FSWordered$Age)
ggplot(data.frame(x = 1:length(FSWcumage), y = FSWcumage), aes(x=x, y=y)) + geom_line() +
xlab("Sample Size") + ylab("Age (Cumulative Average)")
FSWcumage <- cumsum(FSWordered$Age)/1:length(FSWordered$Age)
ggplot(data.frame(x = 1:length(FSWcumage), y = FSWcumage), aes(x=x, y=y)) + geom_line() +
xlab("Sample Size") + ylab("Age (Cumulative Average)")
levels(FSWordered$WAVE)
summary(FSWordered$WAVE)
recruitment <- recruit(FSWdata)
# use locrecruit for things that require location
# first remove any rows that have NA on Lon for either From or To
locrecruit <- recruitment %>% filter(!is.na(FromLon),!is.na(ToLon))
FSWdata %>% arrange(RegistrationDate) %>%
left_join(locrecruit, by = c('RecruitID','To'))
head(locrecruit)
FSWordered <- FSWdata %>% arrange(RegistrationDate) %>%
left_join(locrecruit, by = c('To','RecruitID'))
FSWdata %>% arrange(RegistrationDate) %>%
left_join(locrecruit, by = c('RecruitID' = 'To'))
FSWordered <- FSWdata %>% arrange(RegistrationDate) %>%
left_join(locrecruit, by = c('RecruitID' = 'To')) %>%
select(RecruitID,RegistrationDate,Age,PIN1Lat,PIN1Lon,SIZEWEE,WAVE,Seed)
FSWordered
chains <- list()
chains <- list()
for(i in 1:4){
temp <- FSWordered[Seed == i]
chains[[i]] <- rollmean(temp$Age,15)
}
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i]
chains[[i]] <- rollmean(temp$Age,15)
}
FSWordered$Seed == i
head(FSWdata)
heaf(recruitment)
head(recruitment)
FSWordered <- FSWdata %>% arrange(RegistrationDate) %>%
left_join(recruitment, by = c('RecruitID' = 'To')) %>%
select(RecruitID,RegistrationDate,Age,PIN1Lat,PIN1Lon,SIZEWEE,WAVE,Seed)
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i]
chains[[i]] <- rollmean(temp$Age,15)
}
FSWordered$Seed == i
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i,]
chains[[i]] <- rollmean(temp$Age,15)
}
chains
FSWrdsdata <- as.rds.data.frame(r2, network.size = "network.size",max.coupons = 3)
FSWrdsdata
r <- left_join(recruitment,FSWdata, by = c('To' = "RecruitID"))
r2 <- data.frame(id = r$To,
recruiter.id = r$From,
network.size = as.numeric(r$SIZEWEE),
WAVE = r$WAVE,
r$Age) %>%
filter(!is.na(network.size) )
r2$recruiter.id <- as.character(r2$recruiter.id)
r2$recruiter.id[is.na(r2$recruiter.id)] = 0
FSWrdsdata <- as.rds.data.frame(r2, network.size = "network.size",max.coupons = 3)
bottleneck.plot(FSWrdsdata,'Age')
r$Age
FSWrdsdata
r <- left_join(recruitment,FSWdata, by = c('To' = "RecruitID"))
r2 <- data.frame(id = r$To,
recruiter.id = r$From,
network.size = as.numeric(r$SIZEWEE),
WAVE = r$WAVE,
r$Age,
r$DEMAR) %>%
filter(!is.na(network.size) )
r2$recruiter.id <- as.character(r2$recruiter.id)
r2$recruiter.id[is.na(r2$recruiter.id)] = 0
FSWrdsdata <- as.rds.data.frame(r2, network.size = "network.size",max.coupons = 3)
bottleneck.plot(FSWrdsdata,'DEMAR')
?bottleneck.plot
summary(as.factor(recruitment$Seed))
?rollmean
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i,]
chains[[i]] <- rollmean(temp$Age,15)
}
chains
FSWdata
recruitment
FSWordered <- FSWdata %>% arrange(RegistrationDate) %>%
left_join(recruitment, by = c('RecruitID' = 'To')) %>%
select(RecruitID,RegistrationDate,Age,PIN1Lat,PIN1Lon,SIZEWEE,WAVE,as.factor(Seed))
FSWordered <- FSWdata %>% arrange(RegistrationDate) %>%
left_join(recruitment, by = c('RecruitID' = 'To')) %>%
select(RecruitID,RegistrationDate,Age,PIN1Lat,PIN1Lon,SIZEWEE,WAVE,Seed)
summary(as.factor(FSWordered$Seed))
FSWordered[FSWordered$Seed == i,]
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i,] %>% filter(Age != NA)
chains[[i]] <- rollmean(temp$Age,15)
}
chains
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i,]
chains[[i]] <- rollmean(temp$Age,15)
}
chains
rollmean(temp$Age,15)
temp
FSWordered$Seed == i
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i & FSWordered$Seed != NA,]
chains[[i]] <- rollmean(temp$Age,15)
}
chains
FSWordered[FSWordered$Seed == i & FSWordered$Seed != NA,]
FSWordered$Seed
FSWordered$Seed == i
chains <- list()
for(i in 1:4){
temp <- FSWordered[FSWordered$Seed == i & !is.na(FSWordered$Seed),]
chains[[i]] <- rollmean(temp$Age,15)
}
chains
ggplot(data.frame(x = 1:length(chains[[1]], y = chains[[1]])), aes(x=x,y=y)) + geom_line()
ggplot(data.frame(x = 1:length(chains[[1]]), y = chains[[1]]), aes(x=x,y=y)) + geom_line()
ggplot(data.frame(x = 1:length(chains[[1]]), y = chains[[1]]), aes(x=x,y=y)) + geom_line() +
geom_line(data = (data.frame(x = 1:length(chains[[4]]), y = chains[[4]]),
aes(x=x,y=y, linetype = 'dashed'))
ggplot(data.frame(x = 1:length(chains[[1]]), y = chains[[1]]), aes(x=x,y=y)) + geom_line() +
geom_line(data = (data.frame(x = 1:length(chains[[4]]), y = chains[[4]])),
aes(x=x,y=y, linetype = 'dashed'))
ggplot(data.frame(x = 1:length(chains[[1]]), y = chains[[1]]), aes(x=x,y=y)) + geom_line() +
geom_line(data = (data.frame(x = 1:length(chains[[4]]), y = chains[[4]])),
aes(x=x,y=y), linetype = 'dashed')
ggplot(data.frame(x = 1:length(chains[[1]]), y = chains[[1]]), aes(x=x,y=y)) + geom_line() +
geom_line(data = (data.frame(x = 1:length(chains[[4]]), y = chains[[4]])),
aes(x=x,y=y), linetype = 'dashed', color = 'blue')
ggplot(data.frame(x = 1:length(FSWcumage), y = FSWcumage), aes(x=x, y=y)) + geom_line() +
xlab("Sample Size") + ylab("Age (Cumulative Average)")
ggplot(data.frame(x = 1:length(FSWcumage), y = FSWcumage), aes(x=x, y=y)) + geom_line() +
xlab("Sample Size") + ylab("Age (Cumulative Average)") +
geom_hline(yintercept = mean(FSWordered$Age),linetype='dashed')
ggplot(data.frame(x = 1:length(FSWrollage), y = FSWrollage), aes(x=x, y=y)) + geom_line() +
xlab("Recruitment Order") + ylab("Age (Rolling Average)")+
geom_hline(yintercept = mean(FSWordered$Age),linetype='dashed')
setwd("~/Documents/K27252_LaTeX_Files/big-data-and-social-science")
bookdown::render_book(input = 'index.Rmd')
