chains2 <- NULL
for(i in 1:32){
temp <- MSMordered[MSMordered$Seed == i & !is.na(MSMordered$Seed),]
if(nrow(temp) > 15){
tempdat <- data.frame(rollmean = rollmean(temp$Age,15),
Seed = rep(i,length(rollmean(temp$Age,15))),
Order = 1:length(rollmean(temp$Age,15)))
chains <- rbind(chains,tempdat)
}
tempdat <- data.frame(cumulative = cumsum(temp$Age)/1:nrow(temp),
Order = 1:nrow(temp),
Seed =rep(i,nrow(temp)))
chains2 <- rbind(chains2, tempdat)
}
chains2$Seed <- factor(chains2$Seed)
ggplot(chains2, aes(x = Order, y = cumulative, color = Seed)) + geom_line()
ggplot(chains2, aes(x = Order, y = cumulative, color = Seed)) + geom_line()+
geom_hline(yintercept = mean(MSMordered$Age))
mean(MSMordered$Age)
MSMordered
MSMordered$Age
ggplot(chains2, aes(x = Order, y = cumulative, color = Seed)) + geom_line()+
geom_hline(yintercept = mean(MSMordered$Age, na.rm = TRUE))
ggplot(chains2, aes(x = Order, y = cumulative, color = Seed)) + geom_line() +
geom_hline(yintercept = mean(MSMordered$Age, na.rm = TRUE), linetype ='dashed')
load('/Users/bkim/Documents/Research/Papers/Armenia Data/ArmeniaData/armenia2014.RData')
load('/Users/bkim/Documents/Research/Papers/Armenia Data/ArmeniaData/armenia2016.RData')
load('/Users/bkim/Documents/Research/Papers/Armenia Data/ArmeniaData/armenia2018.RData')
load('/Users/bkim/Documents/Research/Papers/Armenia Data/ArmeniaData/MSMyerevan2018.RData')
load('/Users/bkim/Documents/Research/Papers/Armenia Data/ArmeniaData/armenia_yerevan1416_visibility.RData')
load('/Users/bkim/Documents/Research/Papers/Armenia Data/ArmeniaData/GYUVAN14.RData')
require(devtools)
#install.packages("/Users/bkim/Documents/Research/Papers/CRSSPSE/sspse_0.81.tar.gz", repos=NULL, type='source')
#install_github('https://github.com/HPMRG/sspse', auth_token = 'f9a43103be436d89abfe1352129becede361808d')
require(sspse)
require(RDS)
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none')
fswyer$rc <- (fswyer$in2014==1 & !is.na(fswyer$in2014))
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none')
fswyer
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none') + xlabel('')
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none') + xlab('')
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank()) + xlab('')
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(), axis.ticks.x = element_blank()) +
xlab('')
bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank()) +
xlab('')
bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank()) +
xlab('') + ylab('')
bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
## Yerevan 16-18
fswyer18$rc <- (fswyer18$in2016==1 & !is.na(fswyer18$in2016))
# Gyumri 16-18
fswgyu18$rc <- (fswgyu18$in2016==1 & !is.na(fswgyu18$in2016))
# Vanadzor 16-18
fswvan18$rc <- (fswvan18$in2016==1 & !is.na(fswvan18$in2016))
msmyer$rc <- (msmyer$in2014==1 & !is.na(msmyer$in2014))
## Yerevan 16-18
msmyer18$rc <- (msmyer18$in2016==1 & !is.na(msmyer18$in2016))
# Gyumri 16-18
msmgyu18$rc <- (msmgyu18$in2016==1 & !is.na(msmgyu18$in2016))
# Vanadzor 16-18
msmvan18$rc <- (msmvan18$in2016==1 & !is.na(msmvan18$in2016))
pwidyer$rc <- (pwidyer$in2014==1 & !is.na(pwidyer$in2014))
## Yerevan 16-18
pwidyer18$rc <- (pwidyer18$in2016==1 & !is.na(pwidyer18$in2016))
# Gyumri 16-18
pwidgyu18$rc <- (pwidgyu18$in2016==1 & !is.na(pwidgyu18$in2016))
# Vanadzor 16-18
pwidvan18$rc <- (pwidvan18$in2016==1 & !is.na(pwidvan18$in2016))
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank())
bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
fswyer16bottle <- bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank())
fswyer18bottle <- bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
fswgyu16bottle <- bottleneck.plot(fswgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'FSW Gyumri 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
fswvan16bottle <- bottleneck.plot(fswvan18,'rc') +
facet_wrap(1,labeller = function(x) 'FSW Vanadzor 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
msmyer16bottle <- bottleneck.plot(msmyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank())
msmyer18bottle <- bottleneck.plot(msmyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
msmgyu16bottle <- bottleneck.plot(msmgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'MSM Gyumri 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
msmvan16bottle <- bottleneck.plot(msmvan18,'rc') +
facet_wrap(1,labeller = function(x) 'MSM Vanadzor 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())
pwidyer16bottle <- bottleneck.plot(pwidyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'PWID Yerevan 2016') +
theme(legend.position = 'none')
pwidyer18bottle <- bottleneck.plot(pwidyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'PWID Yerevan 2018') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank())
pwidgyu16bottle <- bottleneck.plot(pwidgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'PWID Gyumri 2016') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank())
pwidvan16bottle <- bottleneck.plot(pwidvan18,'rc') +
facet_wrap(1,labeller = function(x) 'PWID Vanadzor 2016') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank())
multiplot(fswyer16bottle,fswyer18bottle,fswgyu16bottle,fswvan16bottle,
msmyer16bottle,msmyer18bottle,msmgyu16bottle,msmvan16bottle,
pwidyer16bottle,pwidyer18bottle,pwidgyu16bottle,pwidvan16bottle,cols = 4)
multiplot
multiplot(fswyer16bottle,fswyer18bottle,fswgyu16bottle,fswvan16bottle,
msmyer16bottle,msmyer18bottle,msmgyu16bottle,msmvan16bottle,
pwidyer16bottle,pwidyer18bottle,pwidgyu16bottle,pwidvan16bottle,byrow=TRUE,cols = 4)
multiplot(fswyer16bottle,msmyer16bottle,  pwidyer16bottle,
fswyer18bottle,msmyer18bottle,pwidyer18bottle,
fswgyu16bottle,msmgyu16bottle,pwidgyu16bottle,
fswvan16bottle,msmvan16bottle,pwidvan16bottle,cols = 4)
scaling <- scale_x_continuous(limits = c(0,120)) + scale_y_continuous(limits = c(0,1))
scale1 <- scale_x_continuous(limits = c(0,120))
scale2 <- scale_y_continuous(limits = c(0,1))
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank()) +
scale_x_continuous(limits = c(0,120)) + scale_y_continuous(limits = c(0,1))
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank()) +
scale_x_continuous(limits = c(0,125)) + scale_y_continuous(limits = c(0,1))
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank())
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016')
bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank()) +
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswyer16bottle <- bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title.x = element_blank()) +
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswyer18bottle <- bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswgyu16bottle <- bottleneck.plot(fswgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'FSW Gyumri 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswvan16bottle <- bottleneck.plot(fswvan18,'rc') +
facet_wrap(1,labeller = function(x) 'FSW Vanadzor 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmyer16bottle <- bottleneck.plot(msmyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(),axis.title.x = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmyer18bottle <- bottleneck.plot(msmyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmgyu16bottle <- bottleneck.plot(msmgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'MSM Gyumri 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmvan16bottle <- bottleneck.plot(msmvan18,'rc') +
facet_wrap(1,labeller = function(x) 'MSM Vanadzor 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title.x = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidyer16bottle <- bottleneck.plot(pwidyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'PWID Yerevan 2016') +
theme(legend.position = 'none')+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidyer18bottle <- bottleneck.plot(pwidyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'PWID Yerevan 2018') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidgyu16bottle <- bottleneck.plot(pwidgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'PWID Gyumri 2016') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidvan16bottle <- bottleneck.plot(pwidvan18,'rc') +
facet_wrap(1,labeller = function(x) 'PWID Vanadzor 2016') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
multiplot(fswyer16bottle,msmyer16bottle,  pwidyer16bottle,
fswyer18bottle,msmyer18bottle,pwidyer18bottle,
fswgyu16bottle,msmgyu16bottle,pwidgyu16bottle,
fswvan16bottle,msmvan16bottle,pwidvan16bottle,cols = 4)
multiplot
fswyer16bottle <- bottleneck.plot(fswyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(), axis.title = element_blank()) +
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswyer18bottle <- bottleneck.plot(fswyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'FSW Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswgyu16bottle <- bottleneck.plot(fswgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'FSW Gyumri 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
fswvan16bottle <- bottleneck.plot(fswvan18,'rc') +
facet_wrap(1,labeller = function(x) 'FSW Vanadzor 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title = element_blank(),
axis.title.y = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmyer16bottle <- bottleneck.plot(msmyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(),axis.title.x = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmyer18bottle <- bottleneck.plot(msmyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2018') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmgyu16bottle <- bottleneck.plot(msmgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'MSM Gyumri 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmvan16bottle <- bottleneck.plot(msmvan18,'rc') +
facet_wrap(1,labeller = function(x) 'MSM Vanadzor 2016') +
theme(legend.position = 'none',axis.text = element_blank(),
axis.ticks = element_blank(),axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidyer16bottle <- bottleneck.plot(pwidyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'PWID Yerevan 2016') +
theme(legend.position = 'none',axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidyer18bottle <- bottleneck.plot(pwidyer18,c('rc')) +
facet_wrap(1,labeller = function(x) 'PWID Yerevan 2018') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidgyu16bottle <- bottleneck.plot(pwidgyu18,'rc') +
facet_wrap(1,labeller = function(x) 'PWID Gyumri 2016') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
pwidvan16bottle <- bottleneck.plot(pwidvan18,'rc') +
facet_wrap(1,labeller = function(x) 'PWID Vanadzor 2016') +
theme(legend.position = 'none',axis.text.y = element_blank(),
axis.ticks.y = element_blank(), axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
multiplot(fswyer16bottle,msmyer16bottle,pwidyer16bottle,
fswyer18bottle,msmyer18bottle,pwidyer18bottle,
fswgyu16bottle,msmgyu16bottle,pwidgyu16bottle,
fswvan16bottle,msmvan16bottle,pwidvan16bottle,cols = 4)
msmyer16bottle <- bottleneck.plot(msmyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(),axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
msmyer16bottle <- bottleneck.plot(msmyer,c('rc')) +
facet_wrap(1,labeller = function(x) 'MSM Yerevan 2016') +
theme(legend.position = 'none',axis.text.x = element_blank(),
axis.ticks.x = element_blank(),axis.title = element_blank())+
scale_x_continuous(limits = c(0,150)) + scale_y_continuous(limits = c(0,1))
multiplot(fswyer16bottle,msmyer16bottle,pwidyer16bottle,
fswyer18bottle,msmyer18bottle,pwidyer18bottle,
fswgyu16bottle,msmgyu16bottle,pwidgyu16bottle,
fswvan16bottle,msmvan16bottle,pwidvan16bottle,cols = 4)
bottleneckplots <- multiplot(fswyer16bottle,msmyer16bottle,pwidyer16bottle,
fswyer18bottle,msmyer18bottle,pwidyer18bottle,
fswgyu16bottle,msmgyu16bottle,pwidgyu16bottle,
fswvan16bottle,msmvan16bottle,pwidvan16bottle,cols = 4)
bottleneckplots + xlab("Number of Observations")
class(bottleneck.plot())
class(bottleneckplots
)
setwd("~/Documents/K27252_LaTeX_Files/big-data-and-social-science")
bookdown::render_book('index.Rmd')
describe(MSMdata)
require(dplyr)
str(MSMdata)
polyarea2 <- rep(NA, nrow(MSMdata) - 4)
for(i in 1:(nrow(MSMdata) - 4)){
temp <- MSMdata[1:(i+4),] %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
polyarea2[i] <- areaPolygon(temp[chull(temp),])
}
temp
chull(temp)
polyarea2 <- rep(NA, nrow(MSMdata) - 4)
for(i in 1:(nrow(MSMdata) - 4)){
temp <- MSMdata[1:(i+4),] %>% select(PIN1Lon, PIN1Lat)  %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
polyarea2[i] <- areaPolygon(temp[chull(temp),])
}
head(polyarea2)
dat <- data.frame(Recruitment = 1:(nrow(MSMdata) - 4), Area = polyarea2)
ggplot(dat, aes(x=Recruitment, y = Area)) + geom_line()
polyarea3 <- rep(NA, nrow(MSMdata) - 50)
for(i in 1:(nrow(MSMdata) - 50)){
temp <- MSMdata[i:(i+50),] %>% select(PIN1Lon, PIN1Lat)  %>%
filter(PIN1Lat < 1, PIN1Lat > 0)
polyarea3[i] <- areaPolygon(temp[chull(temp),])
}
dat2 <- data.frame(Recruitment = 1:(nrow(MSMdata) - 50), Area = polyarea2)
ggplot(dat2, aes(x=Recruitment, y = Area)) + geom_line()
dat2 <- data.frame(Recruitment = 1:(nrow(MSMdata) - 50), Area = polyarea3)
ggplot(dat2, aes(x=Recruitment, y = Area)) + geom_line()
areas <- list()
polyarea <- rep(NA, max(MSMdata$WAVE, na.rm=TRUE))
for(j in c(2,4,13)){
maxWave <- recruitment %>% filter(Seed == j, !is.na(ToLon), !is.na(Wave)) %>%
select(Wave) %>% max()
polyarea <- rep(NA, max(MSMdata$WAVE, na.rm=TRUE))
for(i in 1:maxWave){
temp <- recruitment %>% filter(Wave <= i,Seed == j, !is.na(ToLon)) %>%
select(ToLon, ToLat) %>%
filter(ToLat < 1, ToLat > 0)
temp <- temp[-chull(temp),]
polyarea[i] <- areaPolygon(temp[chull(temp),])
}
areas[[j]] <- polyarea
}
plot(areas[[4]])
lines(areas[[4]])
points(areas[[2]])
lines(areas[[2]])
points(areas[[13]])
lines(areas[[13]])
table(recruitment$Seed)
order(table(recruitment$Seed))
table(recruitment$Seed)[order(table(recruitment$Seed))]
areas <- list()
polyarea <- rep(NA, max(MSMdata$WAVE, na.rm=TRUE))
for(j in c(1,2,3,4,10,13)){
maxWave <- recruitment %>% filter(Seed == j, !is.na(ToLon), !is.na(Wave)) %>%
select(Wave) %>% max()
polyarea <- rep(NA, max(MSMdata$WAVE, na.rm=TRUE))
for(i in 1:maxWave){
temp <- recruitment %>% filter(Wave <= i,Seed == j, !is.na(ToLon)) %>%
select(ToLon, ToLat) %>%
filter(ToLat < 1, ToLat > 0)
temp <- temp[-chull(temp),]
polyarea[i] <- areaPolygon(temp[chull(temp),])
}
areas[[j]] <- polyarea
}
plot(areas[[1]])
lines(areas[[1]])
points(areas[[2]])
lines(areas[[2]])
points(areas[[3]])
lines(areas[[3]])
points(areas[[4]])
lines(areas[[4]])
points(areas[[10]])
lines(areas[[10]])
points(areas[[13]])
lines(areas[[13]])
plot(areas[[4]])
lines(areas[[4]])
points(areas[[1]])
lines(areas[[1]])
points(areas[[2]])
lines(areas[[2]])
points(areas[[3]])
lines(areas[[3]])
points(areas[[10]])
lines(areas[[10]])
points(areas[[13]])
lines(areas[[13]])
nrow(MSMdata)
650/50
head(MSMdata)
sizes <- rep(NA, 13)
lowerbound <- rep(NA, 13)
upperbound <- rep(NA, 13)
for (i in 1:13){
post <- posteriorsize(MSMdata[1:(50*i),'SIZEWEE'])
sizes[i] <- summary(post)[2,1]
lowerbound[i] <- summary(post)[2,7]
upperbound[i] <- summary(post)[2,8]
}
MSMdata[1:50,]
sizes <- rep(NA, 13)
lowerbound <- rep(NA, 13)
upperbound <- rep(NA, 13)
for (i in 1:13){
post <- posteriorsize(MSMdata %>% arrange(RegistrationDate) %>% head(i*50) %>% select(SIZEWEE))
sizes[i] <- summary(post)[2,1]
lowerbound[i] <- summary(post)[2,7]
upperbound[i] <- summary(post)[2,8]
}
MSMdata %>% arrange(RegistrationDate) %>% head(50) %>% select(SIZEWEE)
######## Size estimate every 50 ########
require(sspse)
help(packages='sspse')
help(package='sspse')
install.packages('sspse')
install.packages('sspse')
install.packages("sspse")
help(package='sspse')
require(sspse)
sizes <- rep(NA, 13)
lowerbound <- rep(NA, 13)
upperbound <- rep(NA, 13)
for (i in 1:13){
post <- posteriorsize(MSMdata %>% arrange(RegistrationDate) %>% head(i*50) %>% select(SIZEWEE))
sizes[i] <- summary(post)[2,1]
lowerbound[i] <- summary(post)[2,7]
upperbound[i] <- summary(post)[2,8]
}
require(dplyr)
require(sspse)
sizes <- rep(NA, 13)
lowerbound <- rep(NA, 13)
upperbound <- rep(NA, 13)
for (i in 1:13){
post <- posteriorsize(MSMdata %>% arrange(RegistrationDate) %>% head(i*50) %>% select(SIZEWEE))
sizes[i] <- summary(post)[2,1]
lowerbound[i] <- summary(post)[2,7]
upperbound[i] <- summary(post)[2,8]
}
require(dplyr)
require(ggplot2)
require(ggmap)
require(geosphere)
require(grid)
require(maptools)
require(rgdal)
require(statnet)
require(sspse)
require(zoo)
install_github('https://github.com/HPMRG/sspse', auth_token = 'f9a43103be436d89abfe1352129becede361808d')
require(devtools)
install_github('https://github.com/HPMRG/sspse', auth_token = 'f9a43103be436d89abfe1352129becede361808d')
require(sspse)
help(package='sspse')
install_github('https://github.com/HPMRG/sspse', auth_token = 'f9a43103be436d89abfe1352129becede361808d')
detach("package:sspse", unload=TRUE)
install_github('https://github.com/HPMRG/sspse', auth_token = 'f9a43103be436d89abfe1352129becede361808d')
